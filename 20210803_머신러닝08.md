### 비지도 학습



#### 비지도 학습

- 결과값 없이 입력값만 주고 학습을 시켜서 유사성을 파악하게 하는 방식 (정답 없음)
- 데이터의 숨겨진 특징이나 구조를 발견하는데 사용
- 정답이 없는 입력 데이터만 이용하기 때문에
- 입력값 자체의 특성과 분포만을 파악해서 그룹핑하는 군집화에 주로 사용





#### 비지도 학습 유형

- 비지도 변환
- 군집(clustering)



#### 비지도 변환

- 데이터를 새롭게 표현하여 사람이나 다른 머신러닝 알고리즘이 원래 데이터보다 쉽게 해석할 수 있도록 만드는 알고리즘
- 차원축소 : 많은 고차원 데이터 특성의 수를 줄이면서 꼭 필요한 특징을 포함한 데이터로 표현하는 방법
- 비지도 변환으로 데이터를 구성하는 단위나 성분을 검색 : 많은 텍스트 문서에서 주제 추출



#### 군집(Clustering)

- 데이터를 비슷한 것끼리 그룹으로 묶는 작업
- K-평균
- DBSCAn



#### 군집화

- 데이터 포인트들을 별개의 군집으로 그룹화하는 것
- 유사성이 높은 데이터들을 동일한 그룹으로 분류
- 서로 다른 군집들이 상이성을 가지도록 그룹화



### K-평균 알고리즘



#### K-평균 (K-Means)

- 군집화에서 가장 일반적으로 사용되는 알고리즘
- 군집 중심점(centroid)이라는 특정한 임의 지점을 선택
- 해당 중심에서 가까운 포인트들을 선택하는 군집화 기법



#### K-평균 (K-Means) 장점

- 알고리즘이 쉽고 간결
- 대용량 데이터에도 활용 가능
- 일반적인 군집화에서 가장 많이 활용되는 알고리즘

#### K-평균 (K-Means) 단점

- 속성의 개수가 많을 경우 군집화 정확도가 떨어짐
- PCA로 차원 축소 적용 필요할수도 있음
- 반복 횟수가 많을 경우 수행 시간 느려짐
- 이상치 데이터에 취약
- 몇개의 군집(cluster)을 선택해야할지 가이드가 어려움



### 군집화 알고리즘 테스트를 위한 데이터 생성



#### 사이킷런의 대표적인 군집화용 데이터 생성기 사용

- make_blobs() : 개별 군집의 중심점과 표준 편차 제어 기능 추가 되어있음



### 군집평가 (Cluster Evaluation)

- 비지도 학습의 특성상
- 어떠한 지표도 정확하게 성능을 평가하기 어렵지만
- 대표적 군집화 성능 평가 방법으로 실루엣 분석 이용



#### 실루엣 분석(Sihoutte Analysis)

- 각 군집 간의 거리가 얼마나 효율적으로 분리되어 있는지 분석
- 효율적 분리 의미
- 군집화가 잘 될수록 개별 군집은 비슷한 정도의 여유 공간을 가지고 떨어져 있음
- 실루엣 계수 (Silhotette coeffcient) 기반



#### 특정 데이터 포인트의 실루엣 계수

- 해당 데이터 포인트와 같은 군집 내에 있는
- 다른 데이터 포인트와의 거리
- 평균한 : a(i)
- 해당 포인트가 속하지 않은 군집 중
- 가장 가까운 군집과의 평균거리 : b(i)
- -1에서 1 사이의 값
- 1로 가까워질수록 근처의 군집과 더 멀리 떨어져 있다는 것
- 0에 가까울수록 근처의 군집과 가까워 진다는 것 
- -값은 아예 다른 군집에 데이터 포인트가 할당되었음을 의미



#### 두 군집 간의 거리가 얼마나 떨어져 있는가의 값

= b(i) - a(i)



#### 좋은 군집화가 되기 위한 기준

- 전체 실루엣 계수 값의 평균값
  - sihouette_score() 값이 0~1 사이의 값을 갖고 1에 가까울수록 좋음
- 전체 실루엣 계수의 평균값과 더불어 개별 군집의 평균값의 편차가 크지 않아야함
- 즉, 개별 군집의 실루엣 계수 평균값이 전체 실루엣 계수의 평군값에서 크게 벗어나지 않는 것이 중요
- 만일 전체 실루엣 계수의 평균값은 높지만
- 특정 군집의 실루엣 계수 평군값만 유난히 높고
- 다른 군집들의 실루엣 계수 평균값은 낮으면 좋은 군집화 조건이 아님



### 기타 군집화 알고리즘



#### 평균이동 (Mean shift)

- K-평균과 유사하지만 
- 거리 중심이 아니라 데이터가 모여 있는 밀도가 가장 높은쪽
- 군집 중심점을 이동하면서 군집화 수행
- 일반 업무 기반의 정형 데이터 셋보다는
- 컴퓨터 비전 영역에서 이미지나 영상 데이터에서
- 특정 개체를 구분하거나 움직임을 추적
- 뛰어난 역할을 수행
- K-평균과 유사하게 중심을 군집의 중심으로 지속적으로 움직이면서 군집화 수행
- 데이터의 분포도를 이용해  군집 중심점을 찾고
- 중심을 데이터가 모여 있는 밀도가 가장 높은 곳을 이동
- K-평균 : 중심에 소속된 데이터의 평균거리 중심으로 이동





#### GMM(Gaussian Mixture Model)

- 군집화를 적용하고자 하는 데이터가
- 여러 개의 가우시난 분포(정규 분포)를 가진 데이터 집합들이 섞여서 생성된 것이라는
- 가정하에 군집화를 수행하는 방식
- 전체 데이터 셋에서 서로 다른 정규 분포 형태를 추출해서
- 다른 정규 분포를 가진 데이터 셋을 각각 군집화하는 것
- 장점 : K-평균보다 유연하게 다양한 데이터 셋에 잘 적용가능
- 단점 : 군집화를 위한 수행 시간이 오래 걸림



#### K-평균과 비교

- K-평균 : 원형 범위에서 군집화 수행
- 데이터 셋이 원형의 범위를 가질수록 군집화 효율은 더 높아짐



#### DBSCAN(Density Based Spatial Clustering)

- 밀도 기반의 군집화의 대표적인 알고리즘
- 특정 공간 내에 데이터 밀도 차이를 기반 알고리즘으로 하고 있어서
- 데이터의 분포가 기하하적으로 복잡한 데이터 셋이세 효과적인 군집화 가능
- K-평균, 평균이동, GMM으로는 효과적인 군집화를 수행하기 어려운 경우 사용



### 군집화 실습 - 고객 세그먼테이션 (Custoemr Segmentation)¶

- 고객 세그먼테이션 군집화 과정
- 데이터 세트 로딩과 데이터 클린징
- 반품이나 CustomerID가 Null인 데이터는 제외
- 영국 이외 국가의 데이터는 제외
  RFM 기반 데이터 가공
- 구매금액 생성
- 고객 기준으로 Recency, Frequency, Monetary 가공
- RFM 기반 고객 세그먼테이션
- Recency, Frequency, Monetary 값의 분포도 확인
- K-Means로 군집화 수행 후에 실루엣 계수 평가
- K-Means 군집화 후에 실루엣 계수 및 군집을 시각화
- 로그 변환 후 재 시각화
